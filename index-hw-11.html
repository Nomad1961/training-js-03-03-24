<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>HW-11</title>
  </head>
  <body>
    <!-- Форма пошуку -->
    <form id="searchForm">
      <label for="queryInput">Пошук:</label>
      <input type="text" name="q" id="queryInput" required />
      <button type="submit">Шукати</button>
    </form>

    <!-- Галерея зображень -->
    <div class="gallery"></div>

    <!-- Індикатор завантаження -->
    <span id="loadingIndicator"><i class="fas fa-spinner fa-spin"></i></span>

    <!-- Скрипт для обробки форми та роботи з API -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/iziToast/1.4.0/js/iziToast.min.js"></script>
    <script src="https://unpkg.com/simplelightbox@2.1.0/dist/simple-lightbox.min.js"></script>
    <link
      rel="stylesheet"
      href="https://unpkg.com/simplelightbox@2.1.0/dist/simple-lightbox.css"
    />
    <style>
      .gallery {
        display: grid;
        gap: 1rem;
      }
      .card {
        width: calc(33% - 0.5rem);
      }
      @media only screen and (max-width: 768px) {
        .card {
          width: 100%;
        }
      }
    </style>

    <script>
      const searchForm = document.getElementById('searchForm');
      const galleryElement = document.querySelector('.gallery');
      const loadingIndicator = document.getElementById('loadingIndicator');

      // Обработка события отправки формы
      searchForm.addEventListener('submit', async function (event) {
        event.preventDefault();

        if (!this.queryInput.value.trim())
          return alert("Заповніть поле 'Пошук'!");

        try {
          // Робимо HTTP-запит до API Pixabay
          const response = await fetch(
            `https://pixabay.com/api/?key=YOUR_API_KEY&q=${encodeURIComponent(
              this.queryInput.value
            )}&image_type=photo&orientation=horizontal`,
            { mode: 'cors' }
          );
          const data = await response.json();

          // Перевіряємо чи є результати пошуку
          if (data.hits.length === 0) {
            new iziToast({
              title: false,
              message: `Нічого не знайдено!`,
              position: 'topCenter',
              timeout: 3000,
              icon: 'fa-exclamation-circle',
              color: '#FFA500',
            });
            return;
          }

          // Виводимо картки зображень
          galleryElement.innerHTML = '';
          data.hits.forEach(hit => {
            const cardTemplate = `
        <a class="card" href="${hit.largeImageURL}">
          <img src="${hit.previewURL}" alt="${hit.tags}">
          <p class="description">${hit.user ? hit.user : ''}: ${
              hit.likes
            } лайків | ${hit.views} переглядів</p>
        </a>
      `;
            galleryElement.insertAdjacentHTML('beforeend', cardTemplate);
          });

          // Додаємо світлову шапку для великих зображень
          new SimpleLightbox('.card a', {
            captionType: 'attr',
            captionsData: 'alt',
          });

          // Приховуємо індикатор завантаження
          loadingIndicator.classList.add('hidden');
        } catch (error) {
          console.log('Error: ', error);
        } finally {
          // Очищаємо галерею перед новим пошуком
          galleryElement.innerHTML = '';
        }
      });

      // Показ індикатора завантаження перед першим запитом
      window.onload = () => {
        loadingIndicator.classList.remove('hidden');
      };
    </script>
  </body>
</html>

<!-- ++++++++++++++++КЛЮЧ-В-hw-11-key.js+++++++++++++++++++++++++++++++++++++ -->
<!-- ++++++++++++++++++подсказка по замене ключа в readme++++++++++++++++++++ -->
